/*! build 2015-05-24 23:05:03 */
/*! rbot.js */
/*! Copyright Francois Lajoie */
/*! MIT License */
"use strict";var app=angular.module("rbot",[]);app.filter("to_trusted",["$sce",function(a){return function(b){return a.trustAsHtml(b)}}]),app.controller("consoleController",["$scope","$http",function(a,b){function c(){return d(a.cmd_input)?void g[a.cmd_input]():void b.post("index.php",{cmd:a.cmd_input}).success(function(a){f.console.innerHTML+="\n"+a,f.console.scrollTop=f.console.scrollHeight}).error(function(){console.log("Cannot resolve: "+a.cmd_input)})}function d(a){return g[a]?!0:!1}function e(){document.body.addEventListener("dblclick",function(){console.log("dlclock"),document.getElementById("cmd").focus()})}a.cmd_history=[],a.cmd_input="$",a.cmd_input_default="$",a.console_last_id=0;var f={cmd:document.getElementById("cmd"),console:document.getElementById("console")},g={clear:function(){f.console.innerHTML=""}};a.getConsoleHistory=function(){b.post("index.php",{h:a.console_last_id}).success(function(a){a.length>0&&(f.console.innerHTML+="\n"+a,f.console.scrollTop=f.console.scrollHeight)}).error(function(){console.log("Cannot retreive history")})},setInterval(function(){a.getConsoleHistory()},1e3),a.cmdTyping=function(b){var d=window.event?b.keyCode:b.which;13==d?"$"===a.cmd_input||""===a.cmd_input?(f.console.innerHTML+="\n",f.console.scrollTop=f.console.scrollHeight):(c(),a.cmd_history.push(a.cmd_input),a.cmd_input=a.cmd_input_default):8==d?"$"==a.cmd_input.trim()&&(a.cmd_input=""):38==d?a.cmd_input=a.cmd_history[a.cmd_history.length-1]:40==d||""==a.cmd_input.trim()&&32==d&&(a.cmd_input="$")},a.focusCmd=function(){f.cmd.focus()},e()}]);